---
layout: post
title: 深入理解 java 虚拟机(2)
date: 2018-08-13 14:16:48
categories: 
- jvm
tags:
- java
- jvm
description: 深入理解 Java 虚拟机:JVM高级特性与最佳实践 读书笔记
---
# 垃圾收集器与内存分配策略

## 那些内存需要回收


Java 堆和方法区中，一个接口中的多个实现类需要的内存可能不一样，一个方法中的多个分支需要内存也可能不一样，我们只有在程序运行期间时才可能知道会创建那些对象，这部分的内存的创建和回收时动态的，垃圾回收器所关注的时这部门内存。
（程序计数器、虚拟机栈、本地方法栈3个区域随线程而生，随线程而灭；栈中的栈帧随着方法的进入和退出而有条不紊的执行者出栈和入栈操作，这几个区域不需要过多考虑回收的问题。）

## 什么时候回收

### 虚拟机回收算法：可达性分析算法

通过一系列称为“GC Roots”的对象作为起始点，从这些支点开始向下搜索，搜索所走过的路径称为引用链（Reference Chain）,当一个对象到Gc Roots 没有任何引用链相连时，则证明此对象时不可用的。
这些对象将会判定为是可回收的对象。

可作为 Gc Roots 的对象
- 虚拟机栈（栈中的本地变量表）中的引用对象
- 方法区中类静态属性引用的对象。
- 方法区中常量引用的对象。
- 本地方法栈中JNI（即一般说的 Native 方法）引用的对象。

Java 将对象的引用分为 强引用（Strong Reference）、软引用（Soft Reference）、弱引用（Weak Reference）、虚引用（Phantom Reference），这四种引用强度依次逐渐减弱。



**未完待续...**